generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [postgis(version: "3.1.7")]
}

model User {
  id                 String             @id @default(uuid())
  firstName          String
  username           String?            @unique
  email              String             @unique
  googleId           String             @unique
  lastName           String?
  picture            String?
  token              String?
  latitude           Float?
  longitude          Float?
  radius             Int?
  clubMembers        ClubMembers[]
  Discussions        Discussions[]
  Posts              Posts[]
  books              UserBooks[]
  sentMessages       DirectMessages[]   @relation("sentMessages")
  receivedMessages   DirectMessages[]   @relation("receivedMessages")
  DiscussionsUsers   DiscussionsUsers[]
  PostsUsers         PostsUsers[]
  friends            Friendship[]       @relation("friend")
  friendships        Friendship[]       @relation("user")
  Notifications      Notifications[]
  NotificationsCount Int                @default(0)
  Activity           Activity[]
  User_Places        User_Places[]
  LendingTable       LendingTable[]
}

model PlacesToRead {
  id              String         @id @default(uuid())
  nickName        String?
  Location        String
  Private         Boolean        @default(false)
  Lat             Int?
  Long            Int?
  altLoc          String?
  Description     String?
  userPlaces      User_Places[]
  LendingTableOut LendingTable[] @relation("outPlace")
  LendingTableIn  LendingTable[] @relation("inPlace")
}

model User_Places {
  id       String       @id @default(uuid())
  user     User         @relation(fields: [userId], references: [id])
  userId   String
  place    PlacesToRead @relation(fields: [placeId], references: [id])
  placeId  String
  Rating   Int?
  Review   String?
  CheckIns Int?

  @@unique([userId, placeId], name: "userId_placeId")
}

model Notifications {
  id         String   @id @default(uuid())
  socketIOid String
  createdAt  DateTime @default(now())
  User       User     @relation(fields: [userId], references: [id])
  userId     String
  body       String
}

model DirectMessages {
  id          String   @id @default(uuid())
  createdAt   DateTime @default(now())
  text        String
  sender      User     @relation("sentMessages", fields: [senderId], references: [id])
  senderId    String
  recipient   User     @relation("receivedMessages", fields: [recipientId], references: [id])
  recipientId String
}

model Books {
  id          String        @id @default(uuid())
  title       String
  author      String
  description String?
  paperback   Boolean?
  content     String?
  image       String?
  ISBN10      String        @unique
  Discussions Discussions[]
  genre       Genre[]
  UserBooks   UserBooks[]
  Activity    Activity[]
}

model Genre {
  id      String  @id @default(uuid())
  booksId String?
  name    String
  books   Books?  @relation(fields: [booksId], references: [id])
}

model UserBooks {
  id           String         @id @default(uuid())
  wishlist     Boolean        @default(false)
  owned        Boolean        @default(false)
  booksId      String
  userId       String
  rating       Float?
  review       String?
  books        Books          @relation(fields: [booksId], references: [id])
  user         User           @relation(fields: [userId], references: [id])
  LendingTable LendingTable[]

  @@unique([userId, booksId], name: "userId_bookId")
}

model bookdata {
  asin       String
  author     String
  image_url  String
  rating     String
  title      String
  url        String
  categories String
  ISBN10     String @id
}

model Clubs {
  id          String        @id @default(uuid())
  name        String        @unique
  admin       String?
  description String?
  image       String?
  clubMembers ClubMembers[]
  Discussions Discussions[]
}

model ClubMembers {
  id     String @id @default(uuid())
  userId String
  clubId String
  club   Clubs  @relation(fields: [clubId], references: [id])
  user   User   @relation(fields: [userId], references: [id])

  @@unique([userId, clubId], name: "userId_clubId")
}

model Discussions {
  id               String             @id @default(uuid())
  userId           String
  title            String
  clubsId          String
  bookId           String?
  thumbsUp         Int                @default(0)
  thumbsDown       Int                @default(0)
  books            Books?             @relation(fields: [bookId], references: [id])
  clubs            Clubs              @relation(fields: [clubsId], references: [id])
  creator          User               @relation(fields: [userId], references: [id])
  Posts            Posts[]
  DiscussionsUsers DiscussionsUsers[]
}

model DiscussionsUsers {
  id           String      @id @default(uuid())
  discussion   Discussions @relation(fields: [discussionId], references: [id])
  discussionId String
  user         User        @relation(fields: [userId], references: [id])
  userId       String
  thumbsUp     Boolean     @default(false)
  thumbsDown   Boolean     @default(false)
}

model Posts {
  id            String       @id @default(uuid())
  userId        String
  body          String
  discussionsId String
  thumbsUp      Int          @default(0)
  thumbsDown    Int          @default(0)
  createdAt     DateTime     @default(now())
  discussion    Discussions  @relation(fields: [discussionsId], references: [id])
  user          User         @relation(fields: [userId], references: [id])
  PostsUsers    PostsUsers[]
}

model PostsUsers {
  id         String  @id @default(uuid())
  post       Posts   @relation(fields: [postId], references: [id])
  postId     String
  user       User    @relation(fields: [userId], references: [id])
  userId     String
  thumbsUp   Boolean @default(false)
  thumbsDown Boolean @default(false)
}

model Activity {
  id        String   @id @default(uuid())
  user      User     @relation(fields: [userId], references: [id])
  userId    String
  type      String
  book      Books    @relation(fields: [bookId], references: [id])
  bookId    String
  createdAt DateTime @default(now())
}

model Friendship {
  id       String @id @default(uuid())
  userId   String
  friendId String
  user     User   @relation("user", fields: [userId], references: [id])
  friend   User   @relation("friend", fields: [friendId], references: [id])
}

model LendingTable {
  id              String        @id @default(uuid())
  LenderBookId    UserBooks     @relation(fields: [lenderId], references: [id])
  lenderId        String
  BorrowID        User          @relation(fields: [borrowerId], references: [id])
  borrowerId      String
  LenderReview    String?
  LenderRating    Int?
  BorrowRating    Int?
  BorrowReview    String?
  DateInPlanned   String?
  DateIn          String?
  Borrowed        Boolean       @default(false)
  Returned        Boolean       @default(false)
  Datebackplanned String?
  DateBack        String?
  placeIn         PlacesToRead? @relation("inPlace", fields: [inPlaceId], references: [id])
  inPlaceId       String?
  placeOut        PlacesToRead? @relation("outPlace", fields: [outPlaceId], references: [id])
  outPlaceId      String?
  InTime          String?
  InDate          String?
  OutTime         String?
  OutDate         String?
}

model spatial_ref_sys {
  srid      Int     @id
  auth_name String? @db.VarChar(256)
  auth_srid Int?
  srtext    String? @db.VarChar(2048)
  proj4text String? @db.VarChar(2048)
}

model us_gaz {
  id        Int     @id(map: "pk_us_gaz") @default(autoincrement())
  seq       Int?
  word      String?
  stdword   String?
  token     Int?
  is_custom Boolean @default(true)
}

model us_lex {
  id        Int     @id(map: "pk_us_lex") @default(autoincrement())
  seq       Int?
  word      String?
  stdword   String?
  token     Int?
  is_custom Boolean @default(true)
}

model us_rules {
  id        Int     @id(map: "pk_us_rules") @default(autoincrement())
  rule      String?
  is_custom Boolean @default(true)
}
