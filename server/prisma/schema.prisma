generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [postgis(version: "3.1.7")]
}

model User {
  id               String             @id @default(uuid())
  firstName        String
  username         String?            @unique
  email            String
  googleId         String             @unique
  lastName         String?
  picture          String?
  token            String?
  latitude         Float?
  longitude        Float?
  radius           Int?
  clubMembers      ClubMembers[]
  Discussions      Discussions[]
  Posts            Posts[]
  books            UserBooks[]
  sentMessages     DirectMessage[]    @relation("sentMessages")
  receivedMessages DirectMessage[]    @relation("receivedMessages")
  DiscussionsUsers DiscussionsUsers[]
  PostsUsers       PostsUsers[]
}

model DirectMessage {
  id          String   @id @default(uuid())
  createdAt   DateTime @default(now())
  text        String
  sender      User     @relation("sentMessages", fields: [senderId], references: [id])
  senderId    String
  recipient   User     @relation("receivedMessages", fields: [recipientId], references: [id])
  recipientId String
}

model Books {
  id          String        @id @default(uuid())
  title       String
  author      String
  description String?
  paperback   Boolean?
  content     String?
  image       String?
  ISBN10      String        @unique
  Discussions Discussions[]
  genre       Genre[]
  UserBooks   UserBooks[]
}

model Genre {
  id      String  @id @default(uuid())
  booksId String?
  name    String
  books   Books?  @relation(fields: [booksId], references: [id])
}

model UserBooks {
  id        String  @id @default(uuid())
  wishlist  Boolean @default(false)
  owned     Boolean @default(false)
  booksId   String
  userId    String
  rating    Float?
  thumbDown Int?
  thumbUp   Int?
  books     Books   @relation(fields: [booksId], references: [id])
  user      User    @relation(fields: [userId], references: [id])

  @@unique([userId, booksId], name: "userId_bookId")
}

model bookdata {
  asin       String
  author     String
  image_url  String
  rating     String
  title      String
  url        String
  categories String
  ISBN10     String @id
}

model Clubs {
  id          String        @id @default(uuid())
  name        String        @unique
  createdBy   String?
  description String?
  image       String?
  clubMembers ClubMembers[]
  Discussions Discussions[]
}

model ClubMembers {
  id     String @id @default(uuid())
  userId String
  clubId String
  club   Clubs  @relation(fields: [clubId], references: [id])
  user   User   @relation(fields: [userId], references: [id])

  @@unique([userId, clubId], name: "userId_clubId")
}

model Discussions {
  id               String             @id @default(uuid())
  userId           String
  title            String
  clubsId          String
  bookId           String?
  thumbsUp         Int                @default(0)
  thumbsDown       Int                @default(0)
  books            Books?             @relation(fields: [bookId], references: [id])
  clubs            Clubs              @relation(fields: [clubsId], references: [id])
  creator          User               @relation(fields: [userId], references: [id])
  Posts            Posts[]
  DiscussionsUsers DiscussionsUsers[]
}

model DiscussionsUsers {
  id           String      @id @default(uuid())
  discussion   Discussions @relation(fields: [discussionId], references: [id])
  discussionId String
  user         User        @relation(fields: [userId], references: [id])
  userId       String
  thumbsUp     Boolean     @default(false)
  thumbsDown   Boolean     @default(false)
}

model Posts {
  id            String       @id @default(uuid())
  userId        String
  body          String
  discussionsId String
  thumbsUp      Int          @default(0)
  thumbsDown    Int          @default(0)
  createdAt     DateTime     @default(now())
  discussion    Discussions  @relation(fields: [discussionsId], references: [id])
  user          User         @relation(fields: [userId], references: [id])
  PostsUsers    PostsUsers[]
}

model PostsUsers {
  id         String  @id @default(uuid())
  post       Posts   @relation(fields: [postId], references: [id])
  postId     String
  user       User    @relation(fields: [userId], references: [id])
  userId     String
  thumbsUp   Boolean @default(false)
  thumbsDown Boolean @default(false)
}

model spatial_ref_sys {
  srid      Int     @id
  auth_name String? @db.VarChar(256)
  auth_srid Int?
  srtext    String? @db.VarChar(2048)
  proj4text String? @db.VarChar(2048)
}

model us_gaz {
  id        Int     @id(map: "pk_us_gaz") @default(autoincrement())
  seq       Int?
  word      String?
  stdword   String?
  token     Int?
  is_custom Boolean @default(true)
}

model us_lex {
  id        Int     @id(map: "pk_us_lex") @default(autoincrement())
  seq       Int?
  word      String?
  stdword   String?
  token     Int?
  is_custom Boolean @default(true)
}

model us_rules {
  id        Int     @id(map: "pk_us_rules") @default(autoincrement())
  rule      String?
  is_custom Boolean @default(true)
}
